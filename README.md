# AdvCF
PyTorch code for our arXiv article:

[**A Differentiable Color Filter for Generating Unrestricted Adversarial Images**](https://arxiv.org/abs/2002.01008)

We propose Adversarial Color Filtering (AdvCF), an approach that uses a differentiable color filter to create adversarial images.
This paper validates two properties of the resulting adversarial images: 1) the photographic quality and appeal of them are maintained or enhanced, even with large perturbations introduced. 2) Higher transferability than conventional L<sub>p</sub> approaches. We also point out that AdvCF could be further improved if image semantics are taken into account.

## Implementation
 
### Requirements
torch>=1.3.1; torchvision>=0.4.2;
### Download data

Run [this official script](https://github.com/tensorflow/cleverhans/blob/master/examples/nips17_adversarial_competition/dataset/download_images.py) to download the dataset.

### Generating adversarial examples with AdvCF

```
python main.py -batch_size 25 -gpu 1 -max_iterations 500 -learning_rate 0.01 -pieces 64 -search_steps 1 -initial_lambda 5
```

### Examples

<p align="center">
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/examples_9.PNG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/examples_7.PNG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/examples_8.PNG" width='1000'alt>
  <em>Fig. 1: From left to right: Original image and adversarial images generated by CW (3x100, κ=20), BIM (ε=8), and our AdvCF (s=1/64, λ=5).</em>
</p>

<br /><br />

<p align="center">
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/ex_2.JPG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/ex_3.JPG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/ex_4.JPG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/ex_6.JPG" width='1000'>
  <img src="https://github.com/ZhengyuZhao/AdvCF/blob/master/figure/ex_7.JPG" width='1000'alt>
  <em>Fig. 2: More examples generated by AdvCF (s=1/64, &lambda;=5). In each group, top: original image, bottom: adversarial image.</em>
</p>
